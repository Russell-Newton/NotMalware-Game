package whatexe.dungeoncrawler.layout.rooms;

import javafx.scene.control.Button;
import whatexe.dungeoncrawler.MainApp;
import whatexe.dungeoncrawler.entities.Player;
import whatexe.dungeoncrawler.entities.doors.SimpleDoor;
import whatexe.dungeoncrawler.layout.Direction;
import whatexe.dungeoncrawler.layout.Level;
import whatexe.tileengine.TiledMap;

import java.io.IOException;

public class BossRoom extends SimpleRoom {

    public BossRoom(TiledMap fromTiledMap, Level owningLevel, Direction fromDirection) {
        super(fromTiledMap, owningLevel, fromDirection);
    }

    @Override
    protected void initDoors(Direction[] directionsToGenerate) {
        super.initDoors(directionsToGenerate);

        // TODO - add door for leaving, which will switch off of "Level" scene and into "Win"
        Button endButton = new Button("Infiltrate");
        endButton.setOnAction(event -> {
            try {
                MainApp.switchScene("EndScreen");
            } catch (IOException e) {
                System.out.println("Could not load end room");
                e.printStackTrace();
            }
        });
        endButton.setTranslateX(this.backgroundImage.getWidth() / 2);
        endButton.setTranslateY(this.backgroundImage.getHeight() / 2);
        endButton.setPrefWidth(100);
        endButton.setPrefHeight(25);

        this.doors.add(new SimpleDoor(endButton,
                                      owningLevel,
                                      directionsToGenerate[0].getOpposite(),
                                      this) {
            @Override
            public void handleOverlap(Player player) {
                try {
                    MainApp.switchScene("EndScreen");
                } catch (IOException e) {
                    e.printStackTrace();
                }
            }
        });
    }

}
