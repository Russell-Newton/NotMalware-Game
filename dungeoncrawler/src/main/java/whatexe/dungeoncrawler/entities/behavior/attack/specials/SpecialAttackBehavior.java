package whatexe.dungeoncrawler.entities.behavior.attack.specials;

import javafx.beans.property.SimpleIntegerProperty;
import whatexe.dungeoncrawler.entities.Entity;
import whatexe.dungeoncrawler.entities.behavior.attack.AttackBehavior;
import whatexe.dungeoncrawler.entities.player.Player;

import java.util.List;

public abstract class SpecialAttackBehavior extends AttackBehavior<Player> {

    private final SimpleIntegerProperty maxRecharge;
    protected int recharge;

    public SpecialAttackBehavior(Player owningEntity, int maxRecharge) {
        super(owningEntity);

        this.maxRecharge = new SimpleIntegerProperty(maxRecharge);
        recharge = getMaxRecharge();
    }

    @Override
    public final List<? extends Entity> attack() {
        if (recharge == getMaxRecharge()) {
            recharge = 0;
            return getDefaultAttackEntities();
        }
        return List.of();
    }

    public int getMaxRecharge() {
        return maxRecharge.get();
    }

    public void setMaxRecharge(int maxRecharge) {
        this.maxRecharge.set(maxRecharge);
    }

    public SimpleIntegerProperty maxRechargeProperty() {
        return maxRecharge;
    }

    public void recharge() {
        recharge = Math.min(recharge + 1, getMaxRecharge());
    }
}
