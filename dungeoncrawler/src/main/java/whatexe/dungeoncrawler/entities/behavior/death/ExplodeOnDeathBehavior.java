package whatexe.dungeoncrawler.entities.behavior.death;

import whatexe.dungeoncrawler.entities.Entity;
import whatexe.dungeoncrawler.entities.behavior.EntityStatistics;
import whatexe.dungeoncrawler.entities.miscellaneous.Explosion;

public class ExplodeOnDeathBehavior extends RemoveOnDeathBehavior {
    public ExplodeOnDeathBehavior(Entity owningEntity) {
        super(owningEntity);
    }

    @Override
    public void die() {
        super.die();

        EntityStatistics statistics
                = new EntityStatistics().copyFrom(owningEntity.getEntityStatistics());

        // Set explosion damage to double the entity's modifified attack damage
        statistics.setAttackDamage(owningEntity.getEntityStatistics().getModifiedAttackDamage());
        statistics.setAttackDamageModifier(1);

        Explosion explosion = new Explosion(owningEntity.getOwningRoom(),
                                            statistics,
                                            7);
        explosion.setEntityPosition(owningEntity.getDisplayNode().getTranslateX(),
                                    owningEntity.getDisplayNode().getTranslateY());

        owningEntity.getOwningRoom().addEntity(explosion);
    }
}
