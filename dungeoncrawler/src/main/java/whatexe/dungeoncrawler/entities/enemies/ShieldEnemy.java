package whatexe.dungeoncrawler.entities.enemies;

import javafx.scene.paint.Color;
import javafx.scene.shape.Rectangle;
import whatexe.dungeoncrawler.entities.Player;
import whatexe.dungeoncrawler.entities.behavior.movement.PathFollowingBehavior;
import whatexe.dungeoncrawler.entities.motionsupport.Vector;
import whatexe.dungeoncrawler.layout.rooms.Room;

public class ShieldEnemy extends Enemy {

    public ShieldEnemy(Room owningRoom) {
        super(new Rectangle(32, 32), 20, owningRoom);
        ((Rectangle) displayNode).setFill(Color.RED);

        Vector roomCenter = new Vector(owningRoom.getBackgroundImage().getWidth() / 2,
                                       owningRoom.getBackgroundImage().getHeight() / 2);
        Vector toCenter =
                roomCenter.minus(new Vector(displayNode.getBoundsInParent().getCenterX(),
                                            displayNode.getBoundsInParent().getCenterY()));
        int xScale = toCenter.dot(new Vector(1, 0)) > 0 ? -1 : 1;
        int yScale = toCenter.dot(new Vector(0, 1)) > 0 ? -1 : 1;

        getBehaviorSet().setMovementBehavior(
                new PathFollowingBehavior(this,
                                          PathFollowingBehavior.FollowType.LOOP,
                                          0.5,
                                          new Vector(0, 0),
                                          new Vector(xScale * 50, 0),
                                          new Vector(xScale * 50, yScale * 50),
                                          new Vector(0, yScale * 50),
                                          new Vector(0, 0)));
    }

    @Override
    public void handleOverlap(Player player) {
        player.adjustHealth(-1);
    }
}
