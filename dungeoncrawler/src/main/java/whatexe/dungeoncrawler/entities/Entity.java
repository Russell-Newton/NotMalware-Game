package whatexe.dungeoncrawler.entities;

import javafx.scene.Node;

public abstract class Entity {
    /**
     * Sprite (or otherwise) used to display the entity to a Scene Graph.
     */
    protected final Node displayNode;
    protected boolean canTick;

    public Entity(Node displayNode) {
        this.displayNode = displayNode;
        canTick = false;
    }

    public Node getDisplayNode() {
        return displayNode;
    }

    public boolean canTick() {
        return canTick;
    }

    public void moveNode(double dx, double dy) {
        if (dx == 0 && dy == 0) {
            return;
        }

        double x = displayNode.getTranslateX();
        double y = displayNode.getTranslateY();

        double xMin = displayNode.getParent().getLayoutBounds().getMinX();
        double yMin = displayNode.getParent().getLayoutBounds().getMinY();
        double xMax = displayNode.getParent().getLayoutBounds().getMaxX()
                - displayNode.getLayoutBounds().getWidth();
        double yMax = displayNode.getParent().getLayoutBounds().getMaxY()
                - displayNode.getLayoutBounds().getHeight();

        //Ensures that the player can't move outside of the parent node bounds
        displayNode.setTranslateX(Math.max(xMin, Math.min(x + dx, xMax)));
        displayNode.setTranslateY(Math.max(yMin, Math.min(y + dy, yMax)));
    }

    public void setEntityPosition(double x, double y) {
        displayNode.setTranslateX(x);
        displayNode.setTranslateY(y);
    }

    public abstract void tick(long now);
}
