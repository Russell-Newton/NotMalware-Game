package whatexe.dungeoncrawler.controllers;

import javafx.fxml.FXML;
import javafx.scene.SubScene;
import javafx.scene.control.Label;
import javafx.scene.control.ProgressBar;
import whatexe.dungeoncrawler.Difficulty;
import whatexe.dungeoncrawler.ManagedController;

import java.util.Map;

public class FirstRoomController extends ManagedController {

    @FXML
    private ProgressBar healthBar; // health bar
    @FXML
    private Label topExit;
    @FXML
    private Label botExit;
    @FXML
    private Label leftExit;
    @FXML
    private Label rightExit;
    @FXML
    private SubScene subScene;
    @FXML
    private Label healthLabel;
    @FXML
    private Label moneyLabel;

    private Difficulty difficulty = Difficulty.NORMAL;

    private int startingHealth;

    private int startingMoney;

    @FXML
    protected void updateHealthBar() { // implement healthBar method here

    }

    @Override
    public void init() {
        // SceneManager.getInstance().addScene("Next Room",
        //         getClass().getResource("NextRoom.fxml"));
        // Recommended setup
        exitRandomize();
        initHealthBar();
        initMoney();
        System.out.println("Initialized First Room");
    }

    protected void initHealthBar() {
        if (difficulty == Difficulty.HARD) { //just example variables
            startingHealth = 100;
            healthLabel.setText("Health: " + startingHealth + " / 100");
        } else if (difficulty == Difficulty.NORMAL) {
            startingHealth = 50;
            healthLabel.setText("Health: " + startingHealth + " / 50");
        } else {
            startingHealth = 20;
            healthLabel.setText("Health: " + startingHealth + " / 20");
        }
        healthBar.setProgress(1);
    }

    protected void initMoney() {
        if (difficulty == Difficulty.HARD) { //just example variables
            startingMoney = 100;
            moneyLabel.setText("Money: " + startingMoney + " / 100");
        } else if (difficulty == Difficulty.NORMAL) {
            startingMoney = 50;
            moneyLabel.setText("Money: " + startingMoney + " / 50");
        } else {
            startingMoney = 20;
            moneyLabel.setText("Money: " + startingMoney + " / 20");
        }
    }

    protected void exitRandomize() {
        Label[] exitArray = {botExit, leftExit, rightExit};
        for (Label exit : exitArray) {
            exit.setVisible((int) (Math.random() * 2) != 0);
        }
    }

    @Override
    public void init(Map<String, Object> loadParameters) {
        // if (loadParameters.containsKey("difficulty")) {
        //     difficulty = (Difficulty) loadParameters.get("difficulty");
        // }
        difficulty = (Difficulty) loadParameters.getOrDefault("difficulty", Difficulty.NORMAL);
        init();
    }
}
